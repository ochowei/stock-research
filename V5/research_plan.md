# **研究計畫：V5-ML 跨截面均值回歸與黑天鵝防禦系統 (Methodology Focused)**

Date: 2025-11-25 11:30 AM  
Topics: \#quant-trading \#system-design \#ai-collaboration \#risk-management  
Status: \#research \#methodology

## **1\. 研究背景與核心問題 (Research Context)**

本計畫旨在構建一套代號為 **"V5-ML"** 的量化交易體系。該體系是針對過往策略（V1-V4）在實證過程中遇到的核心瓶頸所提出的解決方案。

### **1.1 核心問題陳述**

傳統單一標的、單一邏輯的交易策略面臨以下「三元悖論」：

1. **高勝率 vs. 交易頻率：** 追求高勝率的均值回歸策略，訊號往往過於稀疏，導致資金閒置（Cash Drag）。  
2. **短期獲利 vs. 尾部風險：** 賺取流動性溢價的策略（如 V1），本質上呈現「負偏態（Negative Skewness）」，容易在黑天鵝事件中遭受毀滅性打擊（接刀風險）。  
3. **線性指標的侷限性：** 傳統指標（如 RSI、布林通道）假設市場統計特性恆定，無法適應市場體制（Regime）的結構性轉變。

### **1.2 解決方案：V5-ML 體系**

本研究提出將 **「跨截面均值回歸（Cross-Sectional Mean Reversion）」** 與 **「機器學習分層防禦（ML Layered Defense）」** 相結合。利用廣度優先搜索（多標的）解決訊號稀缺問題，並利用非監督式學習識別異常體制，解決左尾風險。

## **2\. 策略方法論 (Strategy Methodology)**

### **2.1 核心假設 (Alpha Hypothesis)**

本策略的超額報酬（Alpha）來源於市場微觀結構中的 **「短期過度反應（Short-Term Overreaction）」** 與 **「流動性提供回報（Liquidity Provision Reward）」**。

* **過度反應假說：** 價格在極短週期內（1-5天）呈現顯著的負序列相關性。當資產遭受非理性的恐慌性拋售時，其價格會暫時低於均衡價值。  
* **大數法則應用：** 單一資產的反轉具有隨機性，但在由 30-50 檔高流動性資產組成的投資組合中，每日選取「偏離度最大」的標的進行交易，可將統計優勢最大化。

### **2.2 基礎模型邏輯 (Base Model: V5)**

V5 被定義為 **「帶有長線趨勢過濾的短週期輪動均值回歸策略」**。

* **標的池 (Universe) 選擇邏輯：**  
  * 選取高流動性成分股（S\&P 100 / Nasdaq 100）。  
  * *理由：* 均值回歸屬薄利策略，必須最小化買賣價差（Bid-Ask Spread）與滑價（Slippage）的衝擊。  
* **市場狀態濾網 (Regime Filter)：**  
  * 條件：$Price \> SMA\_{200}$  
  * *方法論意義：* 順應長期資本流動方向（趨勢），僅在長期上升趨勢中的「暫時回調」進行逆勢操作，避免在結構性熊市中承接跌勢。**(將由 L1 層的 ML 模型進行動態強化)**  
* **進場與輪動 (Entry & Rotation)：**  
  * 訊號：極度超賣 ($RSI(2) \< 10$)。  
  * 橫截面排序 (Cross-Sectional Ranking)：若訊號數量 $N$ \> 資金份額 $K$，則按 $RSI$ 由低至高排序，選取前 $K$ 名。  
  * *方法論意義：* 動態配置資金至「期望反轉幅度最大」的資產，最大化資金效率。  
* **出場機制 (Exit Mechanism)：**  
  * 時間止損 (Time-in-state)：持有 $T\_{max} \= 5$ 天強制平倉。  
  * *理由：* 若價格在 5 天內未回歸，代表市場已消化該訊息並形成新均衡，繼續持有將變成無效的「死錢（Dead Money）」。

## **3\. 邏輯分層架構 (Logical Layered Architecture)**

為了防禦黑天鵝與提升訊號品質，本研究引入機器學習分層架構。這不是軟體模組，而是決策流程的邏輯層級。

### **L0: 數據特徵層 (Data & Feature Layer)**

* **目標：** 將原始價格轉換為描述市場狀態的向量。  
* **關鍵特徵：**  
  * 微觀結構：波動率曲面（Volatility Surface）、相關性矩陣（Correlation Matrix）。  
  * 情緒面：新聞情緒分數（Sentiment Score）。  
  * *方法論重點：* 捕捉市場的「脆弱性（Fragility）」，而非僅僅是價格走勢。

### **L1: 體制識別層 (Regime Identification Layer) \- 防禦**

* **目標：** **強化並動態調整 V5 基礎模型中的靜態「市場狀態濾網」。** 識別當前市場是否處於不適合均值回歸的「崩盤」或「極端異常」狀態，彌補 SMA200 的滯後性。  
* **模型方法：**  
  1. **隱馬可夫模型 (HMM)：** 將市場劃分為潛在狀態（牛市、震盪、崩盤）。  
     * 決策：若 $P(State=Crash) \> Threshold$，觸發熔斷。  
  2. **隔離森林 (Isolation Forest)：** 非監督式異常檢測。  
     * 決策：若特徵向量的「異常分數」過高，視為未知的黑天鵝事件，停止開倉。

### **L2: 策略生成層 (Strategy Generation Layer) \- 攻勢**

* **目標：** 執行 V5 基礎邏輯，生成候選交易訊號。  
* **角色：** 提供高召回率（High Recall）的初篩訊號，確保不錯過任何潛在機會。

### **L3: 元標籤過濾層 (Meta-Labeling Layer) \- 優化**

* **目標：** 估計 L2 產生的訊號最終獲利的「條件機率」。  
* **模型方法：** 監督式學習分類器（XGBoost / Random Forest）。  
* **輸入：** L2 的交易訊號 \+ L0 的市場特徵。  
* **輸出：** $P(Profit | Signal, Context)$。  
* **決策：** 僅當獲利機率 \> $P\_{threshold}$ 時才執行，過濾掉低品質訊號（假陽性）。

## **4\. 研究階段規劃 (Research Phases)**

### **階段一：V5 基礎策略驗證 (Base Strategy Validation)**

**目標：** 確認「多標的輪動」能有效解決均值回歸的資金效率問題，並建立績效基準（Baseline）。

* **研究重點：**  
  * 標的池大小對夏普比率的影響（N=30 vs N=100）。  
  * 輪動排序因子的選擇（RSI vs Bollinger Band %B）。  
  * 固定持有期 vs 技術指標出場的績效差異。

### **階段二：特徵工程與體制模型構建 (Feature & Regime Modeling)**

**目標：** 尋找能夠領先於崩盤發生的市場特徵（Precursors to Crash）。

* **研究重點：**  
  * **相關性崩潰測試：** 驗證在崩盤前夕，標的池內的平均相關係數是否顯著上升。  
  * **HMM 狀態校準：** 訓練 Gaussian HMM，確認其能否正確區分 2020 年與 2022 年的市場體制。  
  * **異常檢測閾值設定：** 利用 Isolation Forest 針對歷史極端事件進行校準。

### **階段三：元標籤模型與合成數據測試 (Meta-Labeling & Stress Test)**

**目標：** 提升策略的勝率與穩健性，特別是在樣本外的表現。

* **研究重點：**  
  * **Triple Barrier Method：** 定義更科學的「獲利/失敗」標籤方法。  
  * **合成數據壓力測試：** 利用 TimeGAN 生成模擬的崩盤路徑，測試 L1 防禦層在「未曾發生過的歷史」中是否依然有效。  
  * **模型可解釋性 (SHAP)：** 分析 L3 模型過濾交易的主要依據，確保邏輯符合金融直覺。

## **5\. 驗證協議 (Verification Protocol)**

為確保 L1 強化層的有效性，需執行以下增量效用驗證：

### **5.1 測試 A：防禦滯後性測試 (Defense Lag Test)**

比較 V5-Base (SMA200) 與 V5-ML (HMM/IsoForest) 對歷史崩盤的反應速度。

* **指標：** 防禦啟動延遲天數 \= (策略停止開倉日 \- 市場見頂日)。  
* **目標：** V5-ML 的延遲天數需小於 5 天 (SMA200 通常需 20+ 天)。  
* **關鍵樣本：** 2020/02 (Covid), 2022/01 (Inflation).

### **5.2 測試 B：訊號毒性過濾 (Toxic Signal Filtering)**

將 L1 層視為二元分類器，分析其對「失敗交易」的過濾能力。

* **有毒訊號定義：** 進場後 5 日內最大回撤 \> 5%。  
* **驗收標準：** V5-ML 需過濾掉 V5-Base 中至少 60% 的有毒訊號 (False Positives)，且不過度犧牲有效訊號 (Recall Drop \< 20%)。

### **5.3 測試 C：合成壓力測試 (Synthetic Stress Test)**

利用 TimeGAN 生成 1,000 條包含未見過崩盤型態的市場路徑。

* **指標：** 破產機率 (Probability of Ruin, PoR)，定義為淨值跌破初始資金 \-30% 的概率。  
* **目標：** V5-ML 的 PoR 需趨近於 0%。

## **6. 未來展望：L4 動態出場層 (Future Work: L4 Dynamic Exit Layer)**

目前 V5 採用規則導向 (Rule-Based) 的出場機制 (固定持有 5 天或 RSI > 70)，以確保策略邏輯的單純性並隔離 L1 與 L3 的效用驗證。然而，為了進一步提升資本效率，未來版本 (V5.1/V6) 將探索以下 ML 優化方向：

### **6.1 預測剩餘潛力 (Predicting Residual Alpha)**
* **概念：** 雖然歷史統計顯示平均持有 5 天最佳，但並非所有交易都需要持有到底。
* **方法：** 訓練一個模型在持倉期間的每一天進行推論。
    * **輸入：** 當前的市場狀態與持倉損益。
    * **輸出：** 預測「如果再多持有一天，期望獲利是否 > 0」。
    * **決策：** 若預測獲利機率低於閾值，即使未滿 5 天也立即出場，釋放資金。

### **6.2 動態三重屏障 (Dynamic Triple Barrier)**
* **概念：** 不同市場狀態下的波動率不同，固定的止損/止盈 % 數無法適應所有情境。
* **方法：** 利用回歸模型 (Regression Model) 預測該筆交易在未來 N 天的潛在波動範圍。
* **應用：** 為每一筆交易動態設定客製化的 Stop Loss 與 Take Profit 寬度 (例如：高波動時放寬止損，低波動時收緊)，實現「動態風險管理」。
